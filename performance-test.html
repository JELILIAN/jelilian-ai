<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JELILIAN æ€§èƒ½æµ‹è¯•</title>
    <style>
        body { font-family: system-ui; padding: 20px; background: #f5f5f5; }
        .test-container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .test-item { margin: 20px 0; padding: 15px; border: 1px solid #e0e0e0; border-radius: 8px; }
        .test-result { margin-top: 10px; font-weight: bold; }
        .good { color: #10b981; }
        .warning { color: #f59e0b; }
        .bad { color: #ef4444; }
        .btn { background: #6366f1; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin: 5px; }
        .progress { width: 100%; height: 20px; background: #e0e0e0; border-radius: 10px; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #6366f1, #8b5cf6); transition: width 0.3s; }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸš€ JELILIAN æ€§èƒ½è¯Šæ–­å·¥å…·</h1>
        <p>æ£€æµ‹ç½‘ç«™æ€§èƒ½é—®é¢˜å¹¶æä¾›ä¼˜åŒ–å»ºè®®</p>
        
        <div class="test-item">
            <h3>ğŸ“Š é¡µé¢åŠ è½½æ€§èƒ½æµ‹è¯•</h3>
            <button class="btn" onclick="testPageLoad()">å¼€å§‹æµ‹è¯•</button>
            <div id="loadTest" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>ğŸŒ ç½‘ç»œèµ„æºæ£€æµ‹</h3>
            <button class="btn" onclick="testResources()">æ£€æµ‹èµ„æº</button>
            <div id="resourceTest" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>ğŸ’¾ å†…å­˜ä½¿ç”¨æƒ…å†µ</h3>
            <button class="btn" onclick="testMemory()">æ£€æµ‹å†…å­˜</button>
            <div id="memoryTest" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>âš¡ JavaScript æ‰§è¡Œæ€§èƒ½</h3>
            <button class="btn" onclick="testJSPerformance()">æµ‹è¯•JSæ€§èƒ½</button>
            <div id="jsTest" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>ğŸ¨ æ¸²æŸ“æ€§èƒ½æµ‹è¯•</h3>
            <button class="btn" onclick="testRenderPerformance()">æµ‹è¯•æ¸²æŸ“</button>
            <div id="renderTest" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>ğŸ“± ç§»åŠ¨ç«¯æ€§èƒ½</h3>
            <button class="btn" onclick="testMobilePerformance()">æµ‹è¯•ç§»åŠ¨ç«¯</button>
            <div id="mobileTest" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>ğŸ”§ ä¼˜åŒ–å»ºè®®</h3>
            <button class="btn" onclick="generateRecommendations()">ç”Ÿæˆå»ºè®®</button>
            <div id="recommendations" class="test-result"></div>
        </div>
        
        <div class="test-item">
            <h3>ğŸš€ å¿«é€Ÿä¿®å¤</h3>
            <button class="btn" onclick="applyQuickFixes()">åº”ç”¨ä¿®å¤</button>
            <div id="quickFixes" class="test-result"></div>
        </div>
    </div>

    <script>
        let testResults = {};
        
        function testPageLoad() {
            const result = document.getElementById('loadTest');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•é¡µé¢åŠ è½½æ€§èƒ½...';
            
            const startTime = performance.now();
            
            // æ¨¡æ‹Ÿé¡µé¢åŠ è½½æµ‹è¯•
            setTimeout(() => {
                const loadTime = performance.now() - startTime;
                const domContentLoaded = performance.getEntriesByType('navigation')[0]?.domContentLoadedEventEnd || 0;
                const loadComplete = performance.getEntriesByType('navigation')[0]?.loadEventEnd || 0;
                
                testResults.pageLoad = {
                    loadTime: loadTime,
                    domContentLoaded: domContentLoaded,
                    loadComplete: loadComplete
                };
                
                let status = 'good';
                let message = '';
                
                if (loadComplete > 3000) {
                    status = 'bad';
                    message = `âŒ é¡µé¢åŠ è½½è¿‡æ…¢ (${(loadComplete/1000).toFixed(2)}ç§’)`;
                } else if (loadComplete > 1500) {
                    status = 'warning';
                    message = `âš ï¸ é¡µé¢åŠ è½½è¾ƒæ…¢ (${(loadComplete/1000).toFixed(2)}ç§’)`;
                } else {
                    message = `âœ… é¡µé¢åŠ è½½è‰¯å¥½ (${(loadComplete/1000).toFixed(2)}ç§’)`;
                }
                
                result.innerHTML = `
                    <div class="${status}">${message}</div>
                    <div>DOMåŠ è½½: ${(domContentLoaded/1000).toFixed(2)}ç§’</div>
                    <div>å®Œå…¨åŠ è½½: ${(loadComplete/1000).toFixed(2)}ç§’</div>
                `;
            }, 100);
        }
        
        function testResources() {
            const result = document.getElementById('resourceTest');
            result.innerHTML = 'æ­£åœ¨æ£€æµ‹ç½‘ç»œèµ„æº...';
            
            const resources = performance.getEntriesByType('resource');
            const slowResources = resources.filter(r => r.duration > 1000);
            const externalResources = resources.filter(r => !r.name.includes(location.hostname));
            
            testResults.resources = {
                total: resources.length,
                slow: slowResources.length,
                external: externalResources.length
            };
            
            let status = 'good';
            let message = '';
            
            if (slowResources.length > 3) {
                status = 'bad';
                message = `âŒ å‘ç° ${slowResources.length} ä¸ªæ…¢é€Ÿèµ„æº`;
            } else if (slowResources.length > 0) {
                status = 'warning';
                message = `âš ï¸ å‘ç° ${slowResources.length} ä¸ªæ…¢é€Ÿèµ„æº`;
            } else {
                message = `âœ… æ‰€æœ‰èµ„æºåŠ è½½æ­£å¸¸`;
            }
            
            result.innerHTML = `
                <div class="${status}">${message}</div>
                <div>æ€»èµ„æºæ•°: ${resources.length}</div>
                <div>å¤–éƒ¨èµ„æº: ${externalResources.length}</div>
                <div>æ…¢é€Ÿèµ„æº: ${slowResources.length}</div>
            `;
        }
        
        function testMemory() {
            const result = document.getElementById('memoryTest');
            result.innerHTML = 'æ­£åœ¨æ£€æµ‹å†…å­˜ä½¿ç”¨...';
            
            if (performance.memory) {
                const memory = performance.memory;
                const usedMB = (memory.usedJSHeapSize / 1024 / 1024).toFixed(2);
                const totalMB = (memory.totalJSHeapSize / 1024 / 1024).toFixed(2);
                const limitMB = (memory.jsHeapSizeLimit / 1024 / 1024).toFixed(2);
                
                testResults.memory = {
                    used: usedMB,
                    total: totalMB,
                    limit: limitMB
                };
                
                let status = 'good';
                let message = '';
                
                if (usedMB > 50) {
                    status = 'bad';
                    message = `âŒ å†…å­˜ä½¿ç”¨è¿‡é«˜ (${usedMB}MB)`;
                } else if (usedMB > 20) {
                    status = 'warning';
                    message = `âš ï¸ å†…å­˜ä½¿ç”¨è¾ƒé«˜ (${usedMB}MB)`;
                } else {
                    message = `âœ… å†…å­˜ä½¿ç”¨æ­£å¸¸ (${usedMB}MB)`;
                }
                
                result.innerHTML = `
                    <div class="${status}">${message}</div>
                    <div>å·²ä½¿ç”¨: ${usedMB}MB</div>
                    <div>æ€»åˆ†é…: ${totalMB}MB</div>
                    <div>é™åˆ¶: ${limitMB}MB</div>
                `;
            } else {
                result.innerHTML = '<div class="warning">âš ï¸ æµè§ˆå™¨ä¸æ”¯æŒå†…å­˜æ£€æµ‹</div>';
            }
        }
        
        function testJSPerformance() {
            const result = document.getElementById('jsTest');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•JavaScriptæ€§èƒ½...';
            
            const startTime = performance.now();
            
            // æ¨¡æ‹Ÿå¤æ‚è®¡ç®—
            let sum = 0;
            for (let i = 0; i < 1000000; i++) {
                sum += Math.random();
            }
            
            const executionTime = performance.now() - startTime;
            
            testResults.jsPerformance = {
                executionTime: executionTime
            };
            
            let status = 'good';
            let message = '';
            
            if (executionTime > 100) {
                status = 'bad';
                message = `âŒ JavaScriptæ‰§è¡Œè¾ƒæ…¢ (${executionTime.toFixed(2)}ms)`;
            } else if (executionTime > 50) {
                status = 'warning';
                message = `âš ï¸ JavaScriptæ‰§è¡Œä¸€èˆ¬ (${executionTime.toFixed(2)}ms)`;
            } else {
                message = `âœ… JavaScriptæ‰§è¡Œè‰¯å¥½ (${executionTime.toFixed(2)}ms)`;
            }
            
            result.innerHTML = `<div class="${status}">${message}</div>`;
        }
        
        function testRenderPerformance() {
            const result = document.getElementById('renderTest');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•æ¸²æŸ“æ€§èƒ½...';
            
            const startTime = performance.now();
            
            // åˆ›å»ºå¤§é‡DOMå…ƒç´ æµ‹è¯•æ¸²æŸ“æ€§èƒ½
            const testContainer = document.createElement('div');
            testContainer.style.position = 'absolute';
            testContainer.style.left = '-9999px';
            document.body.appendChild(testContainer);
            
            for (let i = 0; i < 1000; i++) {
                const div = document.createElement('div');
                div.textContent = `Test element ${i}`;
                div.style.padding = '10px';
                div.style.margin = '5px';
                div.style.background = '#f0f0f0';
                testContainer.appendChild(div);
            }
            
            const renderTime = performance.now() - startTime;
            document.body.removeChild(testContainer);
            
            testResults.renderPerformance = {
                renderTime: renderTime
            };
            
            let status = 'good';
            let message = '';
            
            if (renderTime > 200) {
                status = 'bad';
                message = `âŒ æ¸²æŸ“æ€§èƒ½è¾ƒå·® (${renderTime.toFixed(2)}ms)`;
            } else if (renderTime > 100) {
                status = 'warning';
                message = `âš ï¸ æ¸²æŸ“æ€§èƒ½ä¸€èˆ¬ (${renderTime.toFixed(2)}ms)`;
            } else {
                message = `âœ… æ¸²æŸ“æ€§èƒ½è‰¯å¥½ (${renderTime.toFixed(2)}ms)`;
            }
            
            result.innerHTML = `<div class="${status}">${message}</div>`;
        }
        
        function testMobilePerformance() {
            const result = document.getElementById('mobileTest');
            result.innerHTML = 'æ­£åœ¨æµ‹è¯•ç§»åŠ¨ç«¯æ€§èƒ½...';
            
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            
            testResults.mobile = {
                isMobile: isMobile,
                connection: connection ? connection.effectiveType : 'unknown'
            };
            
            let status = 'good';
            let message = '';
            
            if (isMobile && connection && connection.effectiveType === 'slow-2g') {
                status = 'bad';
                message = `âŒ ç§»åŠ¨ç«¯ç½‘ç»œè¾ƒæ…¢ (${connection.effectiveType})`;
            } else if (isMobile) {
                status = 'warning';
                message = `âš ï¸ ç§»åŠ¨ç«¯è®¾å¤‡ (${connection ? connection.effectiveType : 'æœªçŸ¥ç½‘ç»œ'})`;
            } else {
                message = `âœ… æ¡Œé¢ç«¯è®¾å¤‡`;
            }
            
            result.innerHTML = `
                <div class="${status}">${message}</div>
                <div>è®¾å¤‡ç±»å‹: ${isMobile ? 'ç§»åŠ¨ç«¯' : 'æ¡Œé¢ç«¯'}</div>
                <div>ç½‘ç»œç±»å‹: ${connection ? connection.effectiveType : 'æœªçŸ¥'}</div>
            `;
        }
        
        function generateRecommendations() {
            const result = document.getElementById('recommendations');
            const recommendations = [];
            
            if (testResults.pageLoad && testResults.pageLoad.loadComplete > 2000) {
                recommendations.push('ğŸ”§ ä¼˜åŒ–é¡µé¢åŠ è½½é€Ÿåº¦ï¼šå‹ç¼©CSS/JSæ–‡ä»¶ï¼Œä½¿ç”¨CDN');
            }
            
            if (testResults.resources && testResults.resources.slow > 0) {
                recommendations.push('ğŸŒ ä¼˜åŒ–æ…¢é€Ÿèµ„æºï¼šä½¿ç”¨å›¾ç‰‡å‹ç¼©ï¼Œå¯ç”¨æµè§ˆå™¨ç¼“å­˜');
            }
            
            if (testResults.memory && testResults.memory.used > 30) {
                recommendations.push('ğŸ’¾ ä¼˜åŒ–å†…å­˜ä½¿ç”¨ï¼šå‡å°‘DOMå…ƒç´ ï¼Œæ¸…ç†æœªä½¿ç”¨çš„å˜é‡');
            }
            
            if (testResults.jsPerformance && testResults.jsPerformance.executionTime > 50) {
                recommendations.push('âš¡ ä¼˜åŒ–JavaScriptï¼šä½¿ç”¨Web Workersï¼Œå‡å°‘åŒæ­¥æ“ä½œ');
            }
            
            if (testResults.renderPerformance && testResults.renderPerformance.renderTime > 100) {
                recommendations.push('ğŸ¨ ä¼˜åŒ–æ¸²æŸ“æ€§èƒ½ï¼šä½¿ç”¨CSS transformï¼Œé¿å…é¢‘ç¹é‡æ’');
            }
            
            if (testResults.mobile && testResults.mobile.isMobile) {
                recommendations.push('ğŸ“± ç§»åŠ¨ç«¯ä¼˜åŒ–ï¼šå‡å°‘èµ„æºå¤§å°ï¼Œä½¿ç”¨å“åº”å¼å›¾ç‰‡');
            }
            
            if (recommendations.length === 0) {
                recommendations.push('âœ… ç½‘ç«™æ€§èƒ½è‰¯å¥½ï¼Œæ— éœ€ç‰¹åˆ«ä¼˜åŒ–');
            }
            
            result.innerHTML = recommendations.map(rec => `<div style="margin: 8px 0; padding: 8px; background: #f8f9fa; border-radius: 4px;">${rec}</div>`).join('');
        }
        
        function applyQuickFixes() {
            const result = document.getElementById('quickFixes');
            result.innerHTML = 'æ­£åœ¨åº”ç”¨å¿«é€Ÿä¿®å¤...';
            
            const fixes = [];
            
            // åº”ç”¨ä¸€äº›åŸºæœ¬çš„æ€§èƒ½ä¼˜åŒ–
            const images = document.querySelectorAll('img');
            images.forEach(img => {
                if (!img.loading) {
                    img.loading = 'lazy';
                    fixes.push('âœ… å¯ç”¨å›¾ç‰‡æ‡’åŠ è½½');
                }
            });
            
            // æ·»åŠ é¢„åŠ è½½æç¤º
            const links = document.querySelectorAll('a[href^="http"]');
            links.forEach(link => {
                if (!link.rel) {
                    link.rel = 'noopener';
                    fixes.push('âœ… æ·»åŠ é“¾æ¥å®‰å…¨å±æ€§');
                }
            });
            
            // ä¼˜åŒ–å­—ä½“åŠ è½½
            const fontLinks = document.querySelectorAll('link[href*="fonts.googleapis.com"]');
            fontLinks.forEach(link => {
                if (!link.rel.includes('preconnect')) {
                    fixes.push('âœ… ä¼˜åŒ–å­—ä½“é¢„è¿æ¥');
                }
            });
            
            if (fixes.length === 0) {
                fixes.push('â„¹ï¸ å½“å‰é¡µé¢å·²ç»è¿‡ä¼˜åŒ–');
            }
            
            setTimeout(() => {
                result.innerHTML = fixes.map(fix => `<div style="margin: 4px 0; color: #10b981;">${fix}</div>`).join('');
            }, 1000);
        }
        
        // è‡ªåŠ¨è¿è¡ŒåŸºç¡€æµ‹è¯•
        window.addEventListener('load', function() {
            setTimeout(() => {
                testPageLoad();
                setTimeout(() => testResources(), 500);
                setTimeout(() => testMemory(), 1000);
            }, 1000);
        });
    </script>
</body>
</html>